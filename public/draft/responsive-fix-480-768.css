/* ===== 480-768px レスポンシブ修正 ===== */
/* 問題: comparison-section, details-section, tips-sectionの異常な幅 */

/* 480〜768pxの範囲で適用される修正 */
@media (min-width: 481px) and (max-width: 768px) {
    /* 1. グローバルリセット - 異常な幅を防ぐ */
    * {
        max-width: 100vw !important;
    }
    
    html, body {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: hidden !important;
    }
    
    /* 2. メインコンテナの幅制限 */
    main,
    .container {
        width: 100% !important;
        max-width: 768px !important;
        margin: 0 auto !important;
        box-sizing: border-box !important;
    }
    
    /* body直下の要素から特定の要素を除外 */
    body > *:not(.sidebar-menu):not(.sidebar-overlay):not(.map-modal):not(.disclaimer-modal) {
        width: 100% !important;
        max-width: 768px !important;
        margin: 0 auto !important;
        box-sizing: border-box !important;
    }
    
    /* 3. 比較セクションの修正 - padding込みでも親要素を超えないように */
    .comparison-section {
        width: 100% !important;
        max-width: 100% !important;
        padding: 30px 0 !important; /* 左右のpaddingを削除 */
        box-sizing: border-box !important;
        overflow: hidden !important;
    }
    
    /* 比較セクション内のコンテンツにpaddingを追加 */
    .comparison-section > * {
        padding: 0 15px !important;
    }
    
    .comparison-table {
        width: 100% !important;
        max-width: 100% !important;
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    .comparison-table table {
        width: 100% !important;
        min-width: 600px !important; /* テーブルの最小幅を設定 */
        table-layout: fixed !important;
    }
    
    .table-wrapper {
        width: 100% !important;
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    /* 4. 詳細セクションの修正 - padding込みでも親要素を超えないように */
    .clinic-details-section {
        width: 100% !important;
        max-width: 100% !important;
        padding: 40px 0 !important; /* 左右のpaddingを削除 */
        margin: 40px 0 !important;
        box-sizing: border-box !important;
    }
    
    /* 詳細セクション内のコンテンツにpaddingを追加 */
    .clinic-details-section > * {
        padding: 0 15px !important;
    }
    
    .detail-item {
        width: 100% !important;
        max-width: 100% !important;
        padding: 20px !important;
        box-sizing: border-box !important;
    }
    
    .detail-info-table {
        width: 100% !important;
        overflow-x: auto !important;
    }
    
    /* 5. Tipsセクションの修正 - padding込みでも親要素を超えないように */
    .tips-container {
        width: 100% !important;
        max-width: 100% !important;
        padding: 0 !important; /* 左右のpaddingを削除 */
        margin: 30px 0 !important;
        box-sizing: border-box !important;
    }
    
    /* Tipsセクション内のコンテンツにpaddingを追加 */
    .tips-container > * {
        padding-left: 15px !important;
        padding-right: 15px !important;
    }
    
    .tips-container .tabs {
        width: 100% !important;
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 8px !important;
        justify-content: center !important;
    }
    
    .tips-container .tab {
        flex: 0 1 auto !important;
        padding: 10px 15px !important;
        white-space: nowrap !important;
    }
    
    .tips-container .slider-content {
        width: 100% !important;
        max-width: 100% !important;
        padding: 20px !important;
        box-sizing: border-box !important;
    }
    
    .tips-container .slide {
        width: 100% !important;
        padding: 0 10px !important;
        box-sizing: border-box !important;
    }
    
    /* 6. ランキングセクションの修正 - padding込みでも親要素を超えないように */
    .clinic-rankings {
        width: 100% !important;
        max-width: 100% !important;
        padding: 20px 0 !important; /* 左右のpaddingを削除 */
        box-sizing: border-box !important;
    }
    
    /* ランキングセクション内のコンテンツにpaddingを追加 */
    .clinic-rankings > * {
        padding-left: 15px !important;
        padding-right: 15px !important;
    }
    
    .ranking-container {
        width: 100% !important; /* 幅を100%に設定 */
        max-width: 100% !important;
        display: flex !important;
        flex-wrap: nowrap !important;
        gap: 12px !important;
        padding: 15px 0 !important;
        margin: 0 !important; /* マージンを削除 */
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
        box-sizing: border-box !important;
    }
    
    /* ランキングコンテナのスクロール領域を確保 */
    .clinic-rankings .ranking-container {
        width: calc(100% + 30px) !important; /* 親のpaddingをオフセット */
        margin-left: -15px !important; /* 左側のpaddingをオフセット */
        margin-right: -15px !important; /* 右側のpaddingをオフセット */
        padding-left: 15px !important; /* 内側にpaddingを追加 */
        padding-right: 15px !important; /* 内側にpaddingを追加 */
    }
    
    .ranking-item {
        flex: 0 0 auto !important;
        width: 180px !important;
        min-width: 180px !important;
        max-width: 200px !important;
    }
    
    /* 7. 要素の重なり防止 */
    section {
        width: 100% !important;
        max-width: 100% !important;
        margin-bottom: 40px !important;
        box-sizing: border-box !important;
    }
    
    /* 8. フォントサイズの調整 */
    h1 { font-size: 24px !important; }
    h2 { font-size: 20px !important; }
    h3 { font-size: 18px !important; }
    h4 { font-size: 16px !important; }
    p, li { font-size: 14px !important; }
    
    /* 9. ボタンとリンクの調整 */
    .cta-button,
    .view-details,
    .official-link {
        width: 100% !important;
        max-width: 300px !important;
        margin: 10px auto !important;
        padding: 12px 20px !important;
        font-size: 14px !important;
    }
    
    /* 10. 画像の調整 */
    img {
        max-width: 100% !important;
        height: auto !important;
    }
    
    .clinic-logo {
        max-width: 150px !important;
        margin: 0 auto !important;
    }
    
    /* 11. グリッドレイアウトの調整 */
    .grid-container,
    [class*="grid"] {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
        gap: 15px !important;
        width: 100% !important;
    }
    
    /* 12. フレックスボックスの調整 */
    .flex-container,
    [class*="flex"] {
        flex-wrap: wrap !important;
        gap: 10px !important;
    }
    
    /* 13. パディングとマージンの統一 */
    .section-padding {
        padding: 30px 15px !important;
    }
    
    /* 14. スクロールバーを隠す */
    .ranking-container::-webkit-scrollbar,
    .comparison-table::-webkit-scrollbar,
    .table-wrapper::-webkit-scrollbar {
        height: 6px !important;
    }
    
    .ranking-container::-webkit-scrollbar-thumb,
    .comparison-table::-webkit-scrollbar-thumb,
    .table-wrapper::-webkit-scrollbar-thumb {
        background-color: #ddd !important;
        border-radius: 3px !important;
    }
    
    /* 15. z-indexの調整 */
    .sidebar-menu { z-index: 1100 !important; }
    .modal { z-index: 1200 !important; }
    .hamburger-menu { z-index: 1050 !important; }
    
    /* 16. サイドバーメニューの幅を固定 */
    .sidebar-menu {
        width: 300px !important; /* 元の幅を維持 */
        max-width: 300px !important;
        right: -300px !important; /* 初期状態は画面外 */
    }
    
    .sidebar-menu.active {
        right: 0 !important; /* アクティブ時は表示 */
    }
    
    /* サイドバーオーバーレイも除外 */
    .sidebar-overlay {
        width: 100vw !important;
        max-width: 100vw !important;
    }
}

/* 特定の幅での微調整 */
@media (min-width: 481px) and (max-width: 600px) {
    .ranking-item {
        width: 160px !important;
        min-width: 160px !important;
    }
    
    .tips-container .tab {
        font-size: 13px !important;
        padding: 8px 12px !important;
    }
}

@media (min-width: 601px) and (max-width: 768px) {
    .ranking-item {
        width: 190px !important;
        min-width: 190px !important;
    }
    
    .comparison-table table {
        min-width: 700px !important;
    }
}